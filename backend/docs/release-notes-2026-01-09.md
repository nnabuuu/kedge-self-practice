# 版本更新报告 (2026-01-09)

## 前端 Bug 修复

### 1. 填空题提示状态重置问题
- **问题**：鼠标 hover 到提示按钮时，会导致提示展示状态被重置
- **修复**：修复 `FillInBlankQuestion` 组件的 hint 可见性状态管理
- **提交**：`0e1f291`

### 2. 填空题空值保护
- **问题**：填空题答案为 null 时页面崩溃
- **修复**：添加空值检查和默认值处理

### 3. 多选题格式问题
- **问题**：多选题选项显示格式不正确
- **修复**：修正选项渲染逻辑

### 4. 练习会话恢复问题
- **问题**：刷新页面后练习进度丢失
- **修复**：完善 session restore 逻辑

### 5. 图片 URL 越界问题
- **问题**：图片索引越界导致显示错误
- **修复**：添加边界检查

---

## 后端修复

### 1. 环境变量自动加载
- **问题**：生产环境运行 `node dist/.../main.js` 时不会自动读取 `.env` 文件
- **修复**：在 `main.ts` 顶部添加 `import 'dotenv/config'`
- **提交**：`b83ddb2`

### 2. OSS 上传超时
- **问题**：大文件上传到 OSS 时 60 秒超时
- **修复**：将超时时间增加到 5 分钟
- **提交**：`427514a`

### 3. 项目文件整理
- **问题**：后端根目录散乱着大量文档和脚本文件
- **修复**：整理到 `docs/` 和 `scripts/` 子目录
- **提交**：`e2ba884`

### 4. 新增图片验证脚本
- **功能**：扫描数据库中所有题目，验证图片是否存在
- **提交**：`6dd9136`

---

## 缺失图片报告

| 题目ID | 题目预览 | 图片占位符 | 状态 |
|--------|----------|------------|------|
| `1a1ebb30-dc16-4757-8571-ad74f9e97be1` | 右图所示是民国九年的一则报纸广告... | `{{image:51d16c6c-a43b-4650-b1b8-ec61b8c0e60a}}` | 缺失 |
| `40248d75-6626-484c-8928-664340cc346e` | "宇宙之间，一理而已..."。提出该思想...是 | `{{image:word/media/image16.wmf}}` | 缺失 |
| `7f572049-8286-400e-b8be-06e50034644b` | 16世纪，马丁·路德领导的宗教改革... | `{{image:temp_xcrvdl8e9fn}}` | 缺失 |
| `aa203b98-7e85-46cf-ac35-1b002c7d52c2` | 14世纪与17世纪，欧洲先后出现了两场... | `{{image:0ae399b0-353f-4985-a284-ed38bc081a96}}` | 缺失 |
| `bf0a23d9-f24c-42f3-bd59-c306b030cfb4` | 下图为《15世纪欧洲出现印书坊的城市》... | `{{image:temp_qpmm26xa28b}}` | 缺失 |

### 统计

- **图片有效率**：239/244 (98%)
- **缺失图片**：5 个（2个临时文件、1个Word路径、2个UUID不存在）
