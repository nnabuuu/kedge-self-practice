# 智能自主练习系统 - 接口文档

{% hint style="info" %}
**API版本**: v1 | **基础URL**: `http://localhost:8718` | **编制单位**: 上海即驰教育科技有限公司
{% endhint %}

## 概述

### 接口规范

* **协议**: HTTP/HTTPS
* **数据格式**: JSON
* **字符编码**: UTF-8
* **认证方式**: JWT Bearer Token

### 通用响应格式

```json
{
  "success": true,
  "data": { ... },
  "message": "操作成功"
}
```

### 错误响应格式

```json
{
  "statusCode": 400,
  "message": "错误描述",
  "error": "Bad Request"
}
```

### 认证说明

除公开接口外，所有接口需要在请求头中携带JWT Token：

```
Authorization: Bearer <your_jwt_token>
```

---

## 认证模块 (Auth)

### 用户登录

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /auth/login` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "email": "student001",
  "password": "123456"
}
```

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| email | string | ✅ | 账号ID |
| password | string | ✅ | 密码 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "550e8400-e29b-41d4-a716-446655440000"
  }
}
```
{% endtab %}
{% endtabs %}

### 用户注册

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /auth/register` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "email": "teacher001",
  "password": "123456",
  "name": "张老师",
  "role": "teacher",
  "class": null
}
```

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| email | string | ✅ | 账号ID |
| password | string | ✅ | 密码 |
| name | string | ❌ | 姓名 |
| role | string | ❌ | 角色：student/teacher，默认teacher |
| class | string | ❌ | 班级（学生必填） |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "张老师",
    "role": "teacher"
  }
}
```
{% endtab %}
{% endtabs %}

### 获取用户信息

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /auth/profile` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "张三",
    "email": "student001",
    "role": "student",
    "class": "20250101",
    "preferences": {},
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:00:00.000Z"
  }
}
```
{% endtab %}
{% endtabs %}

### 修改密码

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `PUT /auth/change-password` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "currentPassword": "oldPassword123",
  "newPassword": "newPassword456"
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "message": "密码修改成功"
}
```
{% endtab %}
{% endtabs %}

---

## 题目管理模块 (Quiz)

### 获取题目列表

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /quiz` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| page | number | ❌ | 页码，默认1 |
| limit | number | ❌ | 每页数量，默认10 |
| knowledge_point_id | string | ❌ | 知识点ID，支持逗号分隔多个 |
| search | string | ❌ | 搜索关键词 |
| type | string | ❌ | 题型筛选 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "count": 10,
  "total": 100,
  "page": 1,
  "limit": 10,
  "data": [
    {
      "id": "quiz-001",
      "type": "single-choice",
      "question": "秦朝统一六国是在哪一年？",
      "options": {
        "A": "公元前230年",
        "B": "公元前221年",
        "C": "公元前210年",
        "D": "公元前206年"
      },
      "answer": "B",
      "knowledge_point_id": "kp-001"
    }
  ]
}
```
{% endtab %}
{% endtabs %}

### 根据ID获取题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /quiz/:id` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "id": "quiz-001",
    "type": "single-choice",
    "question": "秦朝统一六国是在哪一年？",
    "options": {
      "A": "公元前230年",
      "B": "公元前221年",
      "C": "公元前210年",
      "D": "公元前206年"
    },
    "answer": "B",
    "explanation": "秦始皇于公元前221年统一六国，建立了中国历史上第一个统一的多民族中央集权国家。",
    "knowledge_point_id": "kp-001"
  }
}
```
{% endtab %}
{% endtabs %}

### 批量获取题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /quiz/by-ids` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| ids | string | ✅ | 题目ID，逗号分隔 |

**示例**: `/quiz/by-ids?ids=id1,id2,id3`
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "total": 3,
  "data": [
    { "id": "id1", ... },
    { "id": "id2", ... },
    { "id": "id3", ... }
  ]
}
```
{% endtab %}
{% endtabs %}

### 提交单个题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /quiz/submit` |
| **认证** | Bearer Token |
| **权限** | 教师 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "quiz": {
    "type": "single-choice",
    "question": "以下哪个是秦朝的首都？",
    "options": {
      "A": "洛阳",
      "B": "咸阳",
      "C": "长安",
      "D": "邺城"
    },
    "answer": "B",
    "explanation": "咸阳是秦朝的首都",
    "knowledgePoint": {
      "id": "kp-001",
      "topic": "秦朝历史"
    }
  }
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "id": "new-quiz-001",
    "type": "single-choice",
    "question": "以下哪个是秦朝的首都？",
    ...
  },
  "knowledgePoint": {
    "id": "kp-001",
    "topic": "秦朝历史"
  }
}
```
{% endtab %}
{% endtabs %}

### 批量提交题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /quiz/submit-multiple` |
| **认证** | Bearer Token |
| **权限** | 教师 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "quizzes": [
    {
      "type": "single-choice",
      "question": "题目1...",
      "options": { "A": "...", "B": "..." },
      "answer": "A"
    },
    {
      "type": "fill-in-the-blank",
      "question": "秦始皇统一六国是在公元前___年",
      "answer": "221"
    }
  ]
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "totalSubmitted": 2,
  "successCount": 2,
  "errorCount": 0,
  "results": [...],
  "errors": []
}
```
{% endtab %}
{% endtabs %}

### 提交带图片的题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /quiz/submit-with-images` |
| **认证** | Bearer Token |
| **权限** | 教师 |
| **Content-Type** | multipart/form-data |
{% endtab %}

{% tab title="请求参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| quiz | string | ✅ | 题目JSON字符串 |
| images | File[] | ❌ | 图片文件，最多10张 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": { ... },
  "attachments": [
    {
      "id": "att-001",
      "url": "/attachments/uuid.png",
      "originalName": "diagram.png",
      "size": 102400,
      "mimetype": "image/png"
    }
  ]
}
```
{% endtab %}
{% endtabs %}

### 更新题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `PUT /quiz/:id` |
| **认证** | Bearer Token |
| **权限** | 教师 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "question": "更新后的题目内容",
  "answer": "B",
  "explanation": "更新后的解析"
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "id": "quiz-001",
    "question": "更新后的题目内容",
    ...
  }
}
```
{% endtab %}
{% endtabs %}

### 删除题目

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `DELETE /quiz/:id` |
| **认证** | Bearer Token |
| **权限** | 教师 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "message": "Quiz deleted successfully"
}
```
{% endtab %}
{% endtabs %}

---

## 练习模块 (Practice)

### 创建练习会话

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /practice/sessions/create` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "subjectId": "history",
  "knowledgePointIds": ["kp-001", "kp-002"],
  "quizTypes": ["single-choice", "fill-in-the-blank"],
  "questionCount": 10,
  "strategy": "new",
  "shuffle": true,
  "showExplanation": true,
  "autoAdvanceDelay": 2
}
```

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| subjectId | string | ❌ | 学科ID |
| knowledgePointIds | string[] | ✅ | 知识点ID数组 |
| quizTypes | string[] | ❌ | 题型数组 |
| questionCount | number | ❌ | 题目数量 |
| strategy | string | ❌ | 策略：new/with-wrong/wrong-only |
| shuffle | boolean | ❌ | 是否打乱顺序 |
| showExplanation | boolean | ❌ | 是否显示解析 |
| autoAdvanceDelay | number | ❌ | 自动跳转延迟(秒) |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "sessionId": "session-001",
    "totalQuestions": 10,
    "quizIds": ["q1", "q2", "q3", ...],
    "config": { ... }
  }
}
```
{% endtab %}
{% endtabs %}

### 提交答案

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /practice/sessions/submit-answer` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "sessionId": "session-001",
  "quizId": "quiz-001",
  "answer": "B",
  "timeSpent": 30
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "isCorrect": true,
    "correctAnswer": "B",
    "explanation": "解析内容..."
  }
}
```
{% endtab %}
{% endtabs %}

### 获取会话详情

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /practice/sessions/:sessionId` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "id": "session-001",
    "userId": "user-001",
    "totalQuestions": 10,
    "answeredQuestions": 5,
    "correctAnswers": 4,
    "incorrectAnswers": 1,
    "isCompleted": false,
    "startTime": "2024-01-01T10:00:00Z"
  }
}
```
{% endtab %}
{% endtabs %}

### 完成练习

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /practice/sessions/complete` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "sessionId": "session-001"
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "sessionId": "session-001",
    "totalQuestions": 10,
    "correctAnswers": 8,
    "incorrectAnswers": 2,
    "score": 80,
    "duration": 600,
    "knowledgePointStats": [...]
  }
}
```
{% endtab %}
{% endtabs %}

### 获取练习历史

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /practice/history` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| page | number | ❌ | 页码 |
| limit | number | ❌ | 每页数量 |
| subjectId | string | ❌ | 学科筛选 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "id": "session-001",
      "subject": "history",
      "totalQuestions": 10,
      "correctAnswers": 8,
      "score": 80,
      "startTime": "2024-01-01T10:00:00Z",
      "duration": 600
    }
  ],
  "pagination": {
    "total": 50,
    "page": 1,
    "limit": 10
  }
}
```
{% endtab %}
{% endtabs %}

### 快速练习选项

{% tabs %}
{% tab title="错题练习" %}
**URL**: `POST /practice/sessions/create-wrong-questions`

创建仅包含错题的练习会话
{% endtab %}

{% tab title="快速练习" %}
**URL**: `POST /practice/sessions/create-quick-practice`

基于上次练习配置快速开始
{% endtab %}

{% tab title="薄弱点练习" %}
**URL**: `POST /practice/sessions/create-weak-points`

针对薄弱知识点的强化练习
{% endtab %}
{% endtabs %}

### AI重新评估

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /practice/sessions/ai-reevaluate` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
| **说明** | 用于填空题等需要AI辅助判定的场景 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "sessionId": "session-001",
  "quizId": "quiz-001",
  "userAnswer": "用户填写的答案"
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "isCorrect": true,
    "confidence": 0.95,
    "reason": "答案与标准答案语义相近"
  }
}
```
{% endtab %}
{% endtabs %}

---

## 知识点模块 (Knowledge Points)

### 搜索知识点

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /knowledge-points/search` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| q | string | ✅ | 搜索关键词 |
| subject | string | ❌ | 学科筛选 |
| limit | number | ❌ | 结果数量限制 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "id": "kp-001",
      "topic": "秦朝的统一",
      "subject": "history",
      "volume": "七年级上册",
      "unit": "第三单元",
      "lesson": "第10课"
    }
  ]
}
```
{% endtab %}
{% endtabs %}

### 获取所有知识点

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /knowledge-points/all` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| subject | string | ✅ | 学科ID |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "id": "kp-001",
      "topic": "秦朝的统一",
      "subject": "history",
      "volume": "七年级上册",
      "unit": "第三单元",
      "lesson": "第10课",
      "quizCount": 25
    }
  ]
}
```
{% endtab %}
{% endtabs %}

### 获取层级选项

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /knowledge-points/hierarchy-options` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "subjects": ["history", "biology"],
    "volumes": {
      "history": ["七年级上册", "七年级下册"],
      "biology": ["七年级上册"]
    },
    "units": { ... }
  }
}
```
{% endtab %}
{% endtabs %}

### 智能知识点匹配

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /knowledge-points/match` |
| **认证** | Bearer Token |
| **权限** | 教师 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "text": "秦始皇统一六国后，采取了哪些巩固统一的措施？",
  "subject": "history"
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "id": "kp-001",
      "topic": "秦朝的统一",
      "confidence": 0.92
    },
    {
      "id": "kp-002",
      "topic": "秦始皇的政策",
      "confidence": 0.85
    }
  ]
}
```
{% endtab %}
{% endtabs %}

---

## DOCX解析模块 (Docx)

### 获取LLM配置

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /docx/llm-provider` |
| **认证** | 无需认证 |
| **权限** | 公开 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "configuration": {
    "apiKeyConfigured": true,
    "baseURL": "https://api.openai.com/v1"
  },
  "models": {
    "quizExtraction": "gpt-4",
    "knowledgeMatching": "gpt-3.5-turbo"
  },
  "providers": {
    "quizExtraction": "openai",
    "knowledgeMatching": "openai"
  }
}
```
{% endtab %}
{% endtabs %}

### 解析DOCX文档（含图片）

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /docx/extract-quiz-with-images` |
| **认证** | Bearer Token |
| **权限** | 教师 |
| **Content-Type** | multipart/form-data |
{% endtab %}

{% tab title="请求参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| file | File | ✅ | DOCX文件 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "quizItems": [
    {
      "type": "single-choice",
      "question": "从文档中提取的题目...",
      "options": { "A": "...", "B": "..." },
      "answer": "A"
    }
  ],
  "extractedImages": [
    {
      "id": "img-001",
      "url": "/v1/attachments/uuid.png",
      "filename": "image1.png",
      "size": 102400,
      "contentType": "image/png"
    }
  ],
  "paragraphs": [...],
  "imageMapping": {
    "img-001": "/v1/attachments/uuid.png"
  }
}
```
{% endtab %}
{% endtabs %}

---

## 排行榜模块 (Leaderboard)

### 练习次数排行

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /leaderboard/practice-count` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| period | string | ❌ | 时间范围：day/week/month/all |
| limit | number | ❌ | 返回数量 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "rank": 1,
      "userId": "user-001",
      "name": "张三",
      "class": "20250101",
      "practiceCount": 50,
      "totalQuestions": 500
    }
  ]
}
```
{% endtab %}
{% endtabs %}

### 正确率排行

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /leaderboard/correct-rate` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "rank": 1,
      "userId": "user-001",
      "name": "李四",
      "class": "20250102",
      "correctRate": 95.5,
      "totalQuestions": 200
    }
  ]
}
```
{% endtab %}
{% endtabs %}

---

## 管理员模块 (Admin)

{% hint style="warning" %}
以下接口需要管理员权限
{% endhint %}

### 获取用户列表

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /admin/users` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="查询参数" %}
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| search | string | ❌ | 搜索关键词 |
| role | string | ❌ | 角色筛选：student/teacher/admin/all |
| page | number | ❌ | 页码 |
| limit | number | ❌ | 每页数量 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": [
    {
      "id": "user-001",
      "email": "student001",
      "name": "张三",
      "role": "student",
      "class": "20250101",
      "isAdmin": false,
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ],
  "pagination": {
    "total": 100,
    "page": 1,
    "limit": 50,
    "totalPages": 2
  }
}
```
{% endtab %}
{% endtabs %}

### 创建用户

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /admin/users` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "account": "student002",
  "password": "123456",
  "name": "李四",
  "role": "student",
  "class": "20250101"
}
```

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| account | string | ✅ | 账号ID |
| password | string | ❌ | 密码（不填则默认为账号） |
| name | string | ✅ | 姓名 |
| role | string | ✅ | 角色：student/teacher/admin |
| class | string | 学生必填 | 班级 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "id": "user-002",
    "email": "student002",
    "name": "李四",
    "role": "student",
    "class": "20250101"
  },
  "message": "User created successfully"
}
```
{% endtab %}
{% endtabs %}

### 批量创建用户

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `POST /admin/users/bulk` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="请求参数" %}
```json
[
  {
    "account": "student003",
    "name": "王五",
    "role": "student",
    "class": "20250101"
  },
  {
    "account": "student004",
    "name": "赵六",
    "role": "student",
    "class": "20250101"
  }
]
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "success": [...],
    "failed": []
  },
  "message": "Created 2 users, 0 failed"
}
```
{% endtab %}
{% endtabs %}

### 修改用户密码

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `PUT /admin/users/:userId/password` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "password": "newPassword123"
}
```
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "message": "Password updated successfully"
}
```
{% endtab %}
{% endtabs %}

### 删除用户

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `DELETE /admin/users/:userId` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "message": "User deleted successfully"
}
```
{% endtab %}
{% endtabs %}

### 用户统计

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /admin/users/stats` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "totalStudents": 500,
    "totalTeachers": 20,
    "totalAdmins": 3,
    "totalUsers": 523,
    "newUsers30Days": 50,
    "activeUsers7Days": 300
  }
}
```
{% endtab %}
{% endtabs %}

---

## 附件模块 (Attachments)

### 获取附件

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /attachments/:fileId` |
| **认证** | Bearer Token |
| **权限** | 已登录用户 |
{% endtab %}

{% tab title="响应" %}
返回文件二进制数据，Content-Type根据文件类型设置
{% endtab %}
{% endtabs %}

### 获取存储统计

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /attachments/stats` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "totalFiles": 1000,
    "totalSize": 524288000,
    "byType": {
      "image/png": 500,
      "image/jpeg": 400,
      "image/gif": 100
    }
  }
}
```
{% endtab %}
{% endtabs %}

---

## 系统配置模块 (System Config)

### 获取配置

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `GET /system-config/:key` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="响应示例" %}
```json
{
  "success": true,
  "data": {
    "key": "openai_api_key",
    "value": "sk-***"
  }
}
```
{% endtab %}
{% endtabs %}

### 更新配置

{% tabs %}
{% tab title="接口信息" %}
| 属性 | 值 |
|------|-----|
| **URL** | `PUT /system-config/:key` |
| **认证** | Bearer Token |
| **权限** | 管理员 |
{% endtab %}

{% tab title="请求参数" %}
```json
{
  "value": "new_config_value"
}
```
{% endtab %}
{% endtabs %}

---

## 错误码说明

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 201 | 创建成功 |
| 400 | 请求参数错误 |
| 401 | 未认证或Token过期 |
| 403 | 权限不足 |
| 404 | 资源不存在 |
| 409 | 资源冲突（如账号已存在） |
| 500 | 服务器内部错误 |

---

## Swagger文档

系统提供在线API文档，访问地址：

```
http://localhost:8718/swagger-ui
```

---

{% hint style="success" %}
**文档信息**

* 编制单位：上海即驰教育科技有限公司
* 文档版本：V1.0
* 最后更新：2025年1月
{% endhint %}
